jQuery(document).ready(function(T){const p="yy-mm-dd";const J="display";const af="active";const L="arrival";const C="departure";let resizeTimer=null;function F(an){return(("number"===typeof an)&&(0<an))}function am(ao,an,ap){return(("string"===typeof ao)&&("object"===typeof an)&&(an.hasOwnProperty(ao))&&(ap===typeof an[ao]))}function g(ao,an,ap){return am(ao,an,ap)?an[ao]:undefined}function H(ao,an){let data=an.getAttribute("data-"+ao);return(null===data)?"":data}function R(ao,ap,an){an.setAttribute("data-"+ao,ap)}function ah(ao,an){an.removeAttribute("data-"+ao)}function aj(an,ap){try{return T.datepicker.formatDate(ap,an)}catch(ao){console.log(ao)}return""}function W(an,ap){try{return T.datepicker.parseDate(ap,an)}catch(ao){console.log(ao)}return null}function I(an,ao,ap){return aj(W(an,ao),ap)}function ac(ao,an){if((null===ao)||(null===an)||("function"!==typeof ao.getTime)||("function"!==typeof an.getTime)){return false}return ao.getTime()===an.getTime()}function N(an,ao,ap){let theDate=W(an,ap);let deadLine=W(ao,ap);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function ad(an,ao,ap){if(an===ao){return true}let theDate=W(an,ap);let deadLine=W(ao,ap);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function K(ao,aq,an,ap){let date=W(ao,ap);let start=W(aq,ap);let end=W(an,ap);return((null!==date)&&(null!==start)&&(null!==end)&&(start<=date)&&(date<=end))}function M(an,ao){let newDate=new Date(an.getTime());newDate.setDate(an.getDate()+ao);return newDate}function q(an,ao){let match=null;let regex=/date-key-(\d{4}-\d{2}-\d{2})/;if(("string"===typeof an)&&(null!==(match=an.match(regex)))&&("string"===typeof match[1])){return I(match[1],p,ao)}return undefined}function x(an){let instance=H("instance",an);return(""===instance)?"0":instance}function w(an){let i=x(an);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].parameters}function D(an,ao){let parameters=w(ao);return(undefined===parameters[an])?null:parameters[an]}function e(ao,an){let id=D(ao+"Id",an);return((null===id)||(""===id))?null:document.getElementById(id)}function O(an,ao){let fields=[];let types=["","Display"];for(let type in types){let input=e(an+types[type],ao);let inputType=null;if((null!==input)&&(null!==(inputType=input.getAttribute("type")))&&("hidden"!==inputType)){fields.push(input)}}return fields}function y(an){let key="Display";let fields=[L+key,C+key];for(let i=0;i<fields.length;i++){let input=e(fields[i],an);if((null!==input)&&("readonly"===input.getAttribute("readonly"))){let title=input.getAttribute("title");if((null!==title)&&(""!==title)){T(input).on("click",function(){alert(this.getAttribute("title"))})}}}}function al(an){let format=D("dateFormat",an);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormat}function ae(an){let format=D("dateFormatDisplay",an);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormatDisplay}function G(an){let currentType=H("type",an);if(""===currentType){currentType=((null===e(L,an))||(null===e(C,an)))?J:af;R("type",currentType,an)}return currentType}function o(an){let i=x(an);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].availability}function s(an){let state=H("state",an);if(""===state){state=L;ab(an,state)}return state}function ab(ao,an){an=("undefined"===typeof an)?L:an;R("state",an,ao);c(an,ao);ag(ao,an)}function ag(ao,an){let type=G(ao);if(type===af){if(an===C){v(ao,availabilityCalendar.messages.confirmDepartureDate)}else{let message=(""===H("selected-arrival",ao))?availabilityCalendar.messages.selectArrivalDate:availabilityCalendar.messages.modifyArrivalDate;v(ao,message)}}}function v(ao,an){let messagesContainer=T(ao.parentNode).find(".availability-calendar-messages").get(0);if(undefined!==messagesContainer){T(messagesContainer).empty();let messageContainer=document.createElement("p");messageContainer.className="prompt-highlight";messageContainer.append(document.createTextNode(an));messagesContainer.append(messageContainer);window.setTimeout(function(ap){T(ap).css("border-color","transparent");window.setTimeout(function(aq){T(aq).removeClass("prompt-highlight");aq.removeAttribute("style")},1000,ap)},1500,messageContainer)}}function d(an){let state=s(an);let newState=(L===state)?C:L;ab(an,newState);if(C===newState){let firstDeparture=T("td.date-key-"+H("first-departure",an));if(0===firstDeparture.length){let stepMonths=(1===T(an).datepicker("option","numberOfMonths"))?1:0;T.datepicker._adjustInstDate(T.datepicker._getInst(an),stepMonths,"M");return}}b(an)}function u(an){let parameters=w(an);let calendarDefault=g("minStay",parameters,"number");return F(calendarDefault)?calendarDefault:availabilityCalendar.defaults.minStay}function n(an,ao){return am(an,ao,"object")}function ak(an,ao){let data=g(an,ao,"object");return(undefined===data)?{}:data}function l(an){let rate=g("rate",an,"string");return(undefined===rate)?"":rate}function P(an){let oldRate=g("oldRate",an,"string");return(undefined===oldRate)?"":oldRate}function Y(an){let available=g("available",an,"boolean");return(undefined===available)?false:available}function r(an){let arrivalAllowed=g("arrival",an,"boolean");return(undefined===arrivalAllowed)?false:arrivalAllowed}function A(an){let departureAllowed=g("departure",an,"boolean");return(undefined===departureAllowed)?false:departureAllowed}function U(an,ao){if(n(an,ao)){return Y(ak(an,ao))}return false}function Q(an,ao){if(n(an,ao)){return A(ak(an,ao))}return false}function E(an,ao){let dates=o(ao);if(n(an,dates)){let dateMinStay=g("minStay",ak(an,dates),"number");if(F(dateMinStay)){return dateMinStay}}return u(ao)}function S(an,ao){let dates=o(ao);let defaultMaxStay=D("maxStay",ao);return(dates.hasOwnProperty(an)&&("number"===typeof dates[an].maxStay)&&(0<dates[an].maxStay))?dates[an].maxStay:((("number"===typeof defaultMaxStay)&&(0<defaultMaxStay))?defaultMaxStay:availabilityCalendar.defaults.maxStay)}function z(ao,an){let format=al(an);return aj(M(W(ao,format),E(ao,an)),format)}function V(ao,an){let dates=o(an);if(!U(ao,dates)){return ao}let format=al(an);let arrivalDate=W(ao,format);let addDays=1;let newDate="";let maxStay=S(ao,an);while(U(newDate=aj(M(arrivalDate,addDays),format),dates)){if(addDays>=maxStay){return newDate}addDays++}return newDate}function aa(ao,an){let dates=o(an);if(Q(ao,dates)){return ao}let lastDate=D("lastDate",an);let format=al(an);let addDays=1;let newDate=aj(M(W(ao,format),addDays),format);while(!Q(newDate,dates)&&ad(newDate,lastDate,format)){addDays++;newDate=aj(M(W(ao,format),addDays),format)}return newDate}function c(an,ao){let oldState=(L===an)?C:L;O(an,ao).forEach(function(ap){try{T(ap.parentNode).removeClass("calendar-deem").addClass("calendar-highlight")}catch(aq){console.log(aq)}});O(oldState,ao).forEach(function(ap){try{T(ap.parentNode).removeClass("calendar-highlight").addClass("calendar-deem")}catch(aq){console.log(aq)}})}function k(ap,ao,ar,aq,an){R("selected-"+ao,ap,ar);let inputField=e(ao,ar);inputField.value=ap;let displayInputField=e(ao+"Display",ar);if(null!==displayInputField){displayInputField.value=(""===ap)?ap:I(ap,aq,an)}}function j(an){let fields=[L,C];for(let index in fields){let field=fields[index];let inputField=e(field,an);if((null!==inputField)&&("string"===typeof inputField.value)&&(""!==inputField.value)){R("selected-"+field,inputField.value,an);let displayInputField=e(field+"Display",an);if(null!==displayInputField){displayInputField.value=I(inputField.value,al(an),ae(an))}}}}function ai(an){if(true===D("showRates",an)){let format=al(an);let dates=o(an);let hideUnavailableRates=D("hideUnavailableRates",an);T(an).find('.ui-datepicker-calendar td.has-rate[class*="date-key-"] > *[class*="ui-state"]').each(function(){let date=q(this.parentNode.className,format);if((0===T(this.parentNode).find(".rate").length)&&(undefined!==date)&&n(date,dates)){let dateData=ak(date,dates);let rate=l(dateData);let available=Y(dateData);if(""!==rate){if(available||(false===hideUnavailableRates)){let oldRate=P(dateData);let hasOldRate=(""!==oldRate);let rateElement=document.createElement("span");rateElement.className=hasOldRate?"rate new-rate":"rate";rateElement.appendChild(document.createTextNode(rate));this.parentNode.appendChild(rateElement);if(hasOldRate){let oldRateElement=document.createElement("span");oldRateElement.className="rate old-rate";oldRateElement.appendChild(document.createTextNode(oldRate));this.parentNode.appendChild(oldRateElement)}}}}})}T(an).find(".ui-datepicker-calendar td[title]").contextmenu(function(ao){ao.preventDefault();try{alert(this.getAttribute("title").replace(/\.\s?/gi,".\n"))}catch(ap){console.log(ap)}});if(af===G(an)){let currentState=s(an);let selector=(L===currentState)?"td.arrival-available.arrival-prohibited":"td.departure-available.departure-prohibited";let message=(L===currentState)?availabilityCalendar.messages.alertNoArrivals:availabilityCalendar.messages.alertNoDepartures;T(an).find(selector).on("click",function(){alert(message)})}}function b(an){window.setTimeout(function(ao){ai(ao)},250,an)}function h(ao,an,ap){return ap.indexOf(ao)===an}function X(an){let classes=[];let messages=[];let state=s(this);let format=D("dateFormat",this);let dates=o(this);let theDateString=aj(an,format);let theDateKey=aj(an,p);classes.push("date-key-"+theDateKey);let firstDate=W(D("firstDate",this),format);let beforeMinDate=(an<firstDate);if(beforeMinDate){classes.push("before-min-date")}let afterMaxDate=(an>W(D("lastDate",this),format));if(afterMaxDate){classes.push("after-max-date")}let hasData=n(theDateString,dates);classes.push(hasData?"has-data":"no-data");let dateData=ak(theDateString,dates);let hideUnavailableRates=D("hideUnavailableRates",this);let rate=l(dateData);let hasRate=(""!==rate);let oldRate=P(dateData);let hasOldRate=(""!==oldRate);if(!beforeMinDate&&!afterMaxDate){classes.push(hasRate?"has-rate":"no-rate");classes.push(hasOldRate?"has-old-rate":"no-old-rate")}let arrivalAvailable=(Y(dateData)&&!(beforeMinDate||afterMaxDate));classes.push(arrivalAvailable?"arrival-available":"arrival-unavailable");let yesterdayDate=M(an,-1);let yesterdayDateString=aj(yesterdayDate,format);let yesterdayData=ak(yesterdayDateString,dates);let departureAvailable=(Y(yesterdayData)&&!(beforeMinDate||afterMaxDate)&&!(yesterdayDate<firstDate));classes.push(departureAvailable?"departure-available":"departure-unavailable");let arrivalAllowed=r(dateData);classes.push(arrivalAllowed?"arrival-allowed":"arrival-prohibited");let departureAllowed=A(dateData);classes.push(departureAllowed?"departure-allowed":"departure-prohibited");if(!beforeMinDate&&!afterMaxDate){if(hasRate&&(Y(dateData)||(false===hideUnavailableRates))){messages.push(availabilityCalendar.messages.rate.replace("{rate}",rate));if(hasOldRate){messages.push(availabilityCalendar.messages.oldRate.replace("{oldRate}",oldRate))}}messages.push(availabilityCalendar.messages.minimumStay.replace("{minimumStay}",E(theDateString,this)));messages.push(arrivalAvailable?availabilityCalendar.messages.available:availabilityCalendar.messages.unavailable);messages.push(arrivalAllowed?availabilityCalendar.messages.arrivalsAllowed:availabilityCalendar.messages.arrivalsNotAllowed);messages.push(departureAllowed?availabilityCalendar.messages.departuresAllowed:availabilityCalendar.messages.departuresNotAllowed)}let canArrive=(arrivalAvailable&&arrivalAllowed);let canDepart=(departureAvailable&&departureAllowed);let selectedArrivalDateString=H("selected-arrival",this);let selectedArrivalDate=W(selectedArrivalDateString,format);let isSelectedArrival=((null!==selectedArrivalDate)&&ac(an,selectedArrivalDate));if(isSelectedArrival){classes.push("selected-arrival");messages.push(availabilityCalendar.messages.selectedArrival);if(!canArrive||beforeMinDate||afterMaxDate){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}}let selectedDepartureDateString=H("selected-departure",this);let selectedDepartureDate=W(selectedDepartureDateString,format);let isSelectedDeparture=((null!==selectedDepartureDate)&&ac(an,selectedDepartureDate));if(isSelectedDeparture){classes.push("selected-departure");messages.push(availabilityCalendar.messages.selectedDeparture);if(!canDepart||beforeMinDate||afterMaxDate){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}if((null!==selectedArrivalDate)&&(null!==selectedDepartureDate)){if((selectedArrivalDate<an)&&(an<selectedDepartureDate)){classes.push("selected-stay");messages.push(availabilityCalendar.messages.selectedStay);if((!arrivalAvailable&&!departureAvailable)||beforeMinDate||afterMaxDate){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.selectedStayConflict)}else{if(!arrivalAvailable){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}else{if(!departureAvailable){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}}}let minimumStayUntilDate=W(z(selectedArrivalDateString,this),format);if((selectedDepartureDate<minimumStayUntilDate)){if(isSelectedArrival){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if(isSelectedDeparture){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if((selectedArrivalDate<an)&&(an<selectedDepartureDate)){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}}}}}let minDepartureDateString=H("first-departure",this);let minStayMessage=false;if((C===state)&&(""!==minDepartureDateString)){if((""!==selectedArrivalDateString)&&(theDateString===selectedArrivalDateString)){classes.push("minimum-stay-requirement");minStayMessage=true}else{if((""!==selectedArrivalDateString)&&(N(selectedArrivalDateString,theDateString,format))&&(N(theDateString,minDepartureDateString,format))){classes.push("minimum-stay-requirement selected-stay");minStayMessage=true}else{if(theDateString===minDepartureDateString){classes.push("minimum-stay-requirement selected-departure");messages.push(availabilityCalendar.messages.firstAvailableDeparture)}}}if(true===minStayMessage){messages.push(availabilityCalendar.messages.minimumStayPeriod)}}let selectable=false;if(L===state){selectable=canArrive}else{selectable=(canDepart&&K(theDateString,H("first-departure",this),H("last-departure",this),format))}let uniqueClasses=classes.filter(h);let uniqueMessages=messages.filter(h);return[selectable,uniqueClasses.join(" "),uniqueMessages.join(" ")]}function t(ao,an,ap){let state=s(ap);if(L===state){let messages=[];let mustDepartOnDateString=V(ao,ap);let minimumStayUntilDateString=z(ao,ap);let firstAllowedDepartureDateString=aa(minimumStayUntilDateString,ap);if(N(mustDepartOnDateString,firstAllowedDepartureDateString,an.settings.dateFormat)){messages.push(availabilityCalendar.messages.arrivalImpossible);messages.push(availabilityCalendar.messages.selectAnotherDate);alert(messages.join("\n"));b(ap);return}k("",C,ap,an.settings.dateFormat,an.settings.altFormat);R("first-departure",firstAllowedDepartureDateString,ap);R("last-departure",mustDepartOnDateString,ap)}else{if(C===state){ah("first-departure",ap);ah("last-departure",ap)}}k(ao,state,ap,an.settings.dateFormat,an.settings.altFormat);d(ap)}function Z(an){let fontSize=window.getComputedStyle(an,null).getPropertyValue("font-size")||"16px";if(""===fontSize){fontSize="16px"}fontSize=parseFloat(fontSize.replace("/[^\d]/",""));return Math.max(1,Math.floor(an.offsetWidth/((fontSize*21)+1)))}function m(an){let instance=T.datepicker._getInst(an);let date=T.datepicker.parseDate("yy-m-d",instance.drawYear+"-"+(1+instance.drawMonth)+"-"+instance.currentDay);let fields=[L,C];for(let f in fields){k("",fields[f],an,instance.settings.dateFormat,instance.settings.altFormat)}let attributes=["selected-arrival","selected-departure","first-departure","last-departure"];for(let a in attributes){ah(attributes[a],an)}ab(an,L);T(an).datepicker("setDate",null);T(an).datepicker("refresh");T(an).datepicker("setDate",date);b(an)}function B(an,ao){j(ao);ab(ao,L);let arrivalInput=e(L,ao);let defaultDate=((null===arrivalInput)||(""===arrivalInput.value))?null:arrivalInput.value;let calendarParameters=w(ao);let parameters={beforeShowDay:X,altFormat:calendarParameters.dateFormatDisplay,dateFormat:calendarParameters.dateFormat,firstDay:calendarParameters.weekStart,defaultDate:defaultDate,gotoCurrent:true,maxDate:calendarParameters.lastDate,minDate:calendarParameters.firstDate,showOtherMonths:false,numberOfMonths:Z(ao),onChangeMonthYear:function(){b(this)},onSelect:function(){b(this)}};let calendarType=G(ao);switch(calendarType){case J:T(ao).datepicker(parameters);break;case af:default:parameters.onSelect=function(aq,ap){t(aq,ap,this)};T(ao).datepicker(parameters);y(ao);break}b(ao)}T(".availability-calendar-clear .clear-button").on("click",function(){try{let calendar=T(T(this).closest(".availability-calendar-wrapper")[0]).find(".availability-calendar.hasDatepicker")[0];if(undefined===calendar){return}m(calendar)}catch(an){console.log(an)}});T(".availability-calendar-help .help-button").on("click",function(){T(this.parentNode.parentNode).toggleClass("state-open")});T(".availability-calendar").each(B);T(window).on("resize",function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){T(".availability-calendar").each(function(an,ao){T(ao).datepicker("option","numberOfMonths",Z(ao));T(ao).datepicker("refresh");b(ao)})},250)})});