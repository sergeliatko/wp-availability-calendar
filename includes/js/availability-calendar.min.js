jQuery(document).ready(function(P){const m="yy-mm-dd";const G="display";const ab="active";const I="arrival";const z="departure";let resizeTimer=null;function C(aj){return(("number"===typeof aj)&&(0<aj))}function ai(ak,aj,al){return(("string"===typeof ak)&&("object"===typeof aj)&&(aj.hasOwnProperty(ak))&&(al===typeof aj[ak]))}function e(ak,aj,al){return ai(ak,aj,al)?aj[ak]:undefined}function E(ak,aj){let data=aj.getAttribute("data-"+ak);return(null===data)?"":data}function N(ak,al,aj){aj.setAttribute("data-"+ak,al)}function ad(ak,aj){aj.removeAttribute("data-"+ak)}function af(aj,al){try{return P.datepicker.formatDate(al,aj)}catch(ak){console.log(ak)}return""}function S(aj,al){try{return P.datepicker.parseDate(al,aj)}catch(ak){console.log(ak)}return null}function F(aj,ak,al){return af(S(aj,ak),al)}function Y(ak,aj){if((null===ak)||(null===aj)||("function"!==typeof ak.getTime)||("function"!==typeof aj.getTime)){return false}return ak.getTime()===aj.getTime()}function K(aj,ak,al){let theDate=S(aj,al);let deadLine=S(ak,al);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function Z(aj,ak,al){if(aj===ak){return true}let theDate=S(aj,al);let deadLine=S(ak,al);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function H(ak,am,aj,al){let date=S(ak,al);let start=S(am,al);let end=S(aj,al);return((null!==date)&&(null!==start)&&(null!==end)&&(start<=date)&&(date<=end))}function J(aj,ak){let newDate=new Date(aj.getTime());newDate.setDate(aj.getDate()+ak);return newDate}function n(aj,ak){let match=null;let regex=/date-key-(\d{4}-\d{2}-\d{2})/;if(("string"===typeof aj)&&(null!==(match=aj.match(regex)))&&("string"===typeof match[1])){return F(match[1],m,ak)}return undefined}function u(aj){let instance=E("instance",aj);return(""===instance)?"0":instance}function t(aj){let i=u(aj);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].parameters}function A(aj,ak){let parameters=t(ak);return(undefined===parameters[aj])?null:parameters[aj]}function d(ak,aj){let id=A(ak+"Id",aj);return((null===id)||(""===id))?null:document.getElementById(id)}function L(aj,ak){let fields=[];let types=["","Display"];for(let type in types){let input=d(aj+types[type],ak);let inputType=null;if((null!==input)&&(null!==(inputType=input.getAttribute("type")))&&("hidden"!==inputType)){fields.push(input)}}return fields}function v(aj){let key="Display";let fields=[I+key,z+key];for(let i=0;i<fields.length;i++){let input=d(fields[i],aj);if((null!==input)&&("readonly"===input.getAttribute("readonly"))){let title=input.getAttribute("title");if((null!==title)&&(""!==title)){P(input).on("click",function(){alert(this.getAttribute("title"))})}}}}function ah(aj){let format=A("dateFormat",aj);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormat}function aa(aj){let format=A("dateFormatDisplay",aj);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormatDisplay}function D(aj){let currentType=E("type",aj);if(""===currentType){currentType=((null===d(I,aj))||(null===d(z,aj)))?G:ab;N("type",currentType,aj)}return currentType}function l(aj){let i=u(aj);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].availability}function p(aj){let state=E("state",aj);if(""===state){state=I;X(aj,state)}return state}function X(ak,aj){aj=("undefined"===typeof aj)?I:aj;N("state",aj,ak);b(aj,ak);ac(ak,aj)}function ac(ak,aj){let type=D(ak);if(type===ab){if(aj===z){s(ak,availabilityCalendar.messages.confirmDepartureDate)}else{let message=(""===E("selected-arrival",ak))?availabilityCalendar.messages.selectArrivalDate:availabilityCalendar.messages.modifyArrivalDate;s(ak,message)}}}function s(ak,aj){let messagesContainer=P(ak.parentNode).find(".availability-calendar-messages").get(0);if(undefined!==messagesContainer){P(messagesContainer).empty();let messageContainer=document.createElement("p");messageContainer.className="prompt-highlight";messageContainer.append(document.createTextNode(aj));messagesContainer.append(messageContainer);window.setTimeout(function(al){P(al).css("border-color","transparent");window.setTimeout(function(am){P(am).removeClass("prompt-highlight");am.removeAttribute("style")},1000,al)},1500,messageContainer)}}function c(aj){let state=p(aj);let newState=(I===state)?z:I;X(aj,newState);if(z===newState){let firstDeparture=P("td.date-key-"+E("first-departure",aj));if(0===firstDeparture.length){let stepMonths=(1===P(aj).datepicker("option","numberOfMonths"))?1:0;P.datepicker._adjustInstDate(P.datepicker._getInst(aj),stepMonths,"M");return}}a(aj)}function r(aj){let parameters=t(aj);let calendarDefault=e("minStay",parameters,"number");return C(calendarDefault)?calendarDefault:availabilityCalendar.defaults.minStay}function k(aj,ak){return ai(aj,ak,"object")}function ag(aj,ak){let data=e(aj,ak,"object");return(undefined===data)?{}:data}function j(aj){let rate=e("rate",aj,"string");return(undefined===rate)?"":rate}function U(aj){let available=e("available",aj,"boolean");return(undefined===available)?false:available}function o(aj){let arrivalAllowed=e("arrival",aj,"boolean");return(undefined===arrivalAllowed)?false:arrivalAllowed}function x(aj){let departureAllowed=e("departure",aj,"boolean");return(undefined===departureAllowed)?false:departureAllowed}function Q(aj,ak){if(k(aj,ak)){return U(ag(aj,ak))}return false}function M(aj,ak){if(k(aj,ak)){return x(ag(aj,ak))}return false}function B(aj,ak){let dates=l(ak);if(k(aj,dates)){let dateMinStay=e("minStay",ag(aj,dates),"number");if(C(dateMinStay)){return dateMinStay}}return r(ak)}function O(aj,ak){let dates=l(ak);let defaultMaxStay=A("maxStay",ak);return(dates.hasOwnProperty(aj)&&("number"===typeof dates[aj].maxStay)&&(0<dates[aj].maxStay))?dates[aj].maxStay:((("number"===typeof defaultMaxStay)&&(0<defaultMaxStay))?defaultMaxStay:availabilityCalendar.defaults.maxStay)}function w(ak,aj){let format=ah(aj);return af(J(S(ak,format),B(ak,aj)),format)}function R(ak,aj){let dates=l(aj);if(!Q(ak,dates)){return ak}let format=ah(aj);let arrivalDate=S(ak,format);let addDays=1;let newDate="";let maxStay=O(ak,aj);while(Q(newDate=af(J(arrivalDate,addDays),format),dates)){if(addDays>=maxStay){return newDate}addDays++}return newDate}function W(ak,aj){let dates=l(aj);if(M(ak,dates)){return ak}let lastDate=A("lastDate",aj);let format=ah(aj);let addDays=1;let newDate=af(J(S(ak,format),addDays),format);while(!M(newDate,dates)&&Z(newDate,lastDate,format)){addDays++;newDate=af(J(S(ak,format),addDays),format)}return newDate}function b(aj,ak){let oldState=(I===aj)?z:I;L(aj,ak).forEach(function(al){try{P(al.parentNode).removeClass("calendar-deem").addClass("calendar-highlight")}catch(am){console.log(am)}});L(oldState,ak).forEach(function(al){try{P(al.parentNode).removeClass("calendar-highlight").addClass("calendar-deem")}catch(am){console.log(am)}})}function h(al,ak,an,am,aj){N("selected-"+ak,al,an);let inputField=d(ak,an);inputField.value=al;let displayInputField=d(ak+"Display",an);if(null!==displayInputField){displayInputField.value=(""===al)?al:F(al,am,aj)}}function g(aj){let fields=[I,z];for(let index in fields){let field=fields[index];let inputField=d(field,aj);if((null!==inputField)&&("string"===typeof inputField.value)&&(""!==inputField.value)){N("selected-"+field,inputField.value,aj);let displayInputField=d(field+"Display",aj);if(null!==displayInputField){displayInputField.value=F(inputField.value,ah(aj),aa(aj))}}}}function ae(aj){if(true===A("showRates",aj)){let format=ah(aj);let dates=l(aj);P(aj).find('.ui-datepicker-calendar td.has-rate[class*="date-key-"] > *[class*="ui-state"]').each(function(){let date=n(this.parentNode.className,format);let rate="";if((undefined!==date)&&k(date,dates)&&(""!==(rate=j(ag(date,dates))))&&(0===P(this.parentNode).find(".rate").length)){let rateElement=document.createElement("span");rateElement.className="rate";rateElement.appendChild(document.createTextNode(rate));this.parentNode.appendChild(rateElement)}})}P(aj).find(".ui-datepicker-calendar td[title]").contextmenu(function(ak){ak.preventDefault();try{alert(this.getAttribute("title").replace(/\.\s?/gi,".\n"))}catch(al){console.log(al)}});if(ab===D(aj)){let currentState=p(aj);let selector=(I===currentState)?"td.arrival-available.arrival-prohibited":"td.departure-available.departure-prohibited";let message=(I===currentState)?availabilityCalendar.messages.alertNoArrivals:availabilityCalendar.messages.alertNoDepartures;P(aj).find(selector).on("click",function(){alert(message)})}}function a(aj){window.setTimeout(function(ak){ae(ak)},250,aj)}function f(ak,aj,al){return al.indexOf(ak)===aj}function T(aj){let classes=[];let messages=[];let state=p(this);let format=A("dateFormat",this);let dates=l(this);let theDateString=af(aj,format);let theDateKey=af(aj,m);classes.push("date-key-"+theDateKey);let firstDate=S(A("firstDate",this),format);let beforeMinDate=(aj<firstDate);if(beforeMinDate){classes.push("before-min-date")}let afterMaxDate=(aj>S(A("lastDate",this),format));if(afterMaxDate){classes.push("after-max-date")}let hasData=k(theDateString,dates);classes.push(hasData?"has-data":"no-data");let dateData=ag(theDateString,dates);let rate=j(dateData);let hasRate=(""!==rate);if(!beforeMinDate&&!afterMaxDate){classes.push(hasRate?"has-rate":"no-rate")}let arrivalAvailable=(U(dateData)&&!(beforeMinDate||afterMaxDate));classes.push(arrivalAvailable?"arrival-available":"arrival-unavailable");let yesterdayDate=J(aj,-1);let yesterdayDateString=af(yesterdayDate,format);let yesterdayData=ag(yesterdayDateString,dates);let departureAvailable=(U(yesterdayData)&&!(beforeMinDate||afterMaxDate)&&!(yesterdayDate<firstDate));classes.push(departureAvailable?"departure-available":"departure-unavailable");let arrivalAllowed=o(dateData);classes.push(arrivalAllowed?"arrival-allowed":"arrival-prohibited");let departureAllowed=x(dateData);classes.push(departureAllowed?"departure-allowed":"departure-prohibited");if(!beforeMinDate&&!afterMaxDate){if(hasRate){messages.push(availabilityCalendar.messages.rate.replace("{rate}",rate))}messages.push(availabilityCalendar.messages.minimumStay.replace("{minimumStay}",B(theDateString,this)));messages.push(arrivalAvailable?availabilityCalendar.messages.available:availabilityCalendar.messages.unavailable);messages.push(arrivalAllowed?availabilityCalendar.messages.arrivalsAllowed:availabilityCalendar.messages.arrivalsNotAllowed);messages.push(departureAllowed?availabilityCalendar.messages.departuresAllowed:availabilityCalendar.messages.departuresNotAllowed)}let canArrive=(arrivalAvailable&&arrivalAllowed);let canDepart=(departureAvailable&&departureAllowed);let selectedArrivalDateString=E("selected-arrival",this);let selectedArrivalDate=S(selectedArrivalDateString,format);let isSelectedArrival=((null!==selectedArrivalDate)&&Y(aj,selectedArrivalDate));if(isSelectedArrival){classes.push("selected-arrival");messages.push(availabilityCalendar.messages.selectedArrival);if(!canArrive||beforeMinDate||afterMaxDate){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}}let selectedDepartureDateString=E("selected-departure",this);let selectedDepartureDate=S(selectedDepartureDateString,format);let isSelectedDeparture=((null!==selectedDepartureDate)&&Y(aj,selectedDepartureDate));if(isSelectedDeparture){classes.push("selected-departure");messages.push(availabilityCalendar.messages.selectedDeparture);if(!canDepart||beforeMinDate||afterMaxDate){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}if((null!==selectedArrivalDate)&&(null!==selectedDepartureDate)){if((selectedArrivalDate<aj)&&(aj<selectedDepartureDate)){classes.push("selected-stay");messages.push(availabilityCalendar.messages.selectedStay);if((!arrivalAvailable&&!departureAvailable)||beforeMinDate||afterMaxDate){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.selectedStayConflict)}else{if(!arrivalAvailable){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}else{if(!departureAvailable){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}}}let minimumStayUntilDate=S(w(selectedArrivalDateString,this),format);if((selectedDepartureDate<minimumStayUntilDate)){if(isSelectedArrival){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if(isSelectedDeparture){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if((selectedArrivalDate<aj)&&(aj<selectedDepartureDate)){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}}}}}let minDepartureDateString=E("first-departure",this);let minStayMessage=false;if((z===state)&&(""!==minDepartureDateString)){if((""!==selectedArrivalDateString)&&(theDateString===selectedArrivalDateString)){classes.push("minimum-stay-requirement");minStayMessage=true}else{if((""!==selectedArrivalDateString)&&(K(selectedArrivalDateString,theDateString,format))&&(K(theDateString,minDepartureDateString,format))){classes.push("minimum-stay-requirement selected-stay");minStayMessage=true}else{if(theDateString===minDepartureDateString){classes.push("minimum-stay-requirement selected-departure");messages.push(availabilityCalendar.messages.firstAvailableDeparture)}}}if(true===minStayMessage){messages.push(availabilityCalendar.messages.minimumStayPeriod)}}let selectable=false;if(I===state){selectable=canArrive}else{selectable=(canDepart&&H(theDateString,E("first-departure",this),E("last-departure",this),format))}let uniqueClasses=classes.filter(f);let uniqueMessages=messages.filter(f);return[selectable,uniqueClasses.join(" "),uniqueMessages.join(" ")]}function q(ak,aj,al){let state=p(al);if(I===state){let messages=[];let mustDepartOnDateString=R(ak,al);let minimumStayUntilDateString=w(ak,al);let firstAllowedDepartureDateString=W(minimumStayUntilDateString,al);if(K(mustDepartOnDateString,firstAllowedDepartureDateString,aj.settings.dateFormat)){messages.push(availabilityCalendar.messages.arrivalImpossible);messages.push(availabilityCalendar.messages.selectAnotherDate);alert(messages.join("\n"));a(al);return}h("",z,al,aj.settings.dateFormat,aj.settings.altFormat);N("first-departure",firstAllowedDepartureDateString,al);N("last-departure",mustDepartOnDateString,al)}else{if(z===state){ad("first-departure",al);ad("last-departure",al)}}h(ak,state,al,aj.settings.dateFormat,aj.settings.altFormat);c(al)}function V(aj){return Math.max(1,Math.floor(aj.offsetWidth/317.2))}function y(aj,ak){g(ak);X(ak,I);let arrivalInput=d(I,ak);let defaultDate=((null===arrivalInput)||(""===arrivalInput.value))?null:arrivalInput.value;let calendarParameters=t(ak);let parameters={beforeShowDay:T,altFormat:calendarParameters.dateFormatDisplay,dateFormat:calendarParameters.dateFormat,firstDay:calendarParameters.weekStart,defaultDate:defaultDate,gotoCurrent:true,maxDate:calendarParameters.lastDate,minDate:calendarParameters.firstDate,showOtherMonths:false,numberOfMonths:V(ak),onChangeMonthYear:function(){a(this)},onSelect:function(){a(this)}};let calendarType=D(ak);switch(calendarType){case G:P(ak).datepicker(parameters);break;case ab:default:parameters.onSelect=function(am,al){q(am,al,this)};P(ak).datepicker(parameters);v(ak);break}a(ak)}P(".availability-calendar-help .help-button").on("click",function(){P(this.parentNode.parentNode).toggleClass("state-open")});P(".availability-calendar").each(y);P(window).on("resize",function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){P(".availability-calendar").each(function(aj,ak){P(ak).datepicker("option","numberOfMonths",V(ak));P(ak).datepicker("refresh");a(ak)})},250)})});