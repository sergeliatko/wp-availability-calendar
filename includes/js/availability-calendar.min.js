jQuery(document).ready(function(S){const p="yy-mm-dd";const J="display";const ae="active";const L="arrival";const C="departure";let resizeTimer=null;function F(am){return(("number"===typeof am)&&(0<am))}function al(an,am,ao){return(("string"===typeof an)&&("object"===typeof am)&&(am.hasOwnProperty(an))&&(ao===typeof am[an]))}function g(an,am,ao){return al(an,am,ao)?am[an]:undefined}function H(an,am){let data=am.getAttribute("data-"+an);return(null===data)?"":data}function Q(an,ao,am){am.setAttribute("data-"+an,ao)}function ag(an,am){am.removeAttribute("data-"+an)}function ai(am,ao){try{return S.datepicker.formatDate(ao,am)}catch(an){console.log(an)}return""}function V(am,ao){try{return S.datepicker.parseDate(ao,am)}catch(an){console.log(an)}return null}function I(am,an,ao){return ai(V(am,an),ao)}function ab(an,am){if((null===an)||(null===am)||("function"!==typeof an.getTime)||("function"!==typeof am.getTime)){return false}return an.getTime()===am.getTime()}function N(am,an,ao){let theDate=V(am,ao);let deadLine=V(an,ao);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function ac(am,an,ao){if(am===an){return true}let theDate=V(am,ao);let deadLine=V(an,ao);return((null!==theDate)&&(null!==deadLine)&&(theDate<deadLine))}function K(an,ap,am,ao){let date=V(an,ao);let start=V(ap,ao);let end=V(am,ao);return((null!==date)&&(null!==start)&&(null!==end)&&(start<=date)&&(date<=end))}function M(am,an){let newDate=new Date(am.getTime());newDate.setDate(am.getDate()+an);return newDate}function q(am,an){let match=null;let regex=/date-key-(\d{4}-\d{2}-\d{2})/;if(("string"===typeof am)&&(null!==(match=am.match(regex)))&&("string"===typeof match[1])){return I(match[1],p,an)}return undefined}function x(am){let instance=H("instance",am);return(""===instance)?"0":instance}function w(am){let i=x(am);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].parameters}function D(am,an){let parameters=w(an);return(undefined===parameters[am])?null:parameters[am]}function e(an,am){let id=D(an+"Id",am);return((null===id)||(""===id))?null:document.getElementById(id)}function O(am,an){let fields=[];let types=["","Display"];for(let type in types){let input=e(am+types[type],an);let inputType=null;if((null!==input)&&(null!==(inputType=input.getAttribute("type")))&&("hidden"!==inputType)){fields.push(input)}}return fields}function y(am){let key="Display";let fields=[L+key,C+key];for(let i=0;i<fields.length;i++){let input=e(fields[i],am);if((null!==input)&&("readonly"===input.getAttribute("readonly"))){let title=input.getAttribute("title");if((null!==title)&&(""!==title)){S(input).on("click",function(){alert(this.getAttribute("title"))})}}}}function ak(am){let format=D("dateFormat",am);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormat}function ad(am){let format=D("dateFormatDisplay",am);return(("string"===typeof format)&&(""!==format))?format:availabilityCalendar.defaults.dateFormatDisplay}function G(am){let currentType=H("type",am);if(""===currentType){currentType=((null===e(L,am))||(null===e(C,am)))?J:ae;Q("type",currentType,am)}return currentType}function o(am){let i=x(am);return(undefined===availabilityCalendar.calendars[i])?{}:availabilityCalendar.calendars[i].availability}function s(am){let state=H("state",am);if(""===state){state=L;aa(am,state)}return state}function aa(an,am){am=("undefined"===typeof am)?L:am;Q("state",am,an);c(am,an);af(an,am)}function af(an,am){let type=G(an);if(type===ae){if(am===C){v(an,availabilityCalendar.messages.confirmDepartureDate)}else{let message=(""===H("selected-arrival",an))?availabilityCalendar.messages.selectArrivalDate:availabilityCalendar.messages.modifyArrivalDate;v(an,message)}}}function v(an,am){let messagesContainer=S(an.parentNode).find(".availability-calendar-messages").get(0);if(undefined!==messagesContainer){S(messagesContainer).empty();let messageContainer=document.createElement("p");messageContainer.className="prompt-highlight";messageContainer.append(document.createTextNode(am));messagesContainer.append(messageContainer);window.setTimeout(function(ao){S(ao).css("border-color","transparent");window.setTimeout(function(ap){S(ap).removeClass("prompt-highlight");ap.removeAttribute("style")},1000,ao)},1500,messageContainer)}}function d(am){let state=s(am);let newState=(L===state)?C:L;aa(am,newState);if(C===newState){let firstDeparture=S("td.date-key-"+H("first-departure",am));if(0===firstDeparture.length){let stepMonths=(1===S(am).datepicker("option","numberOfMonths"))?1:0;S.datepicker._adjustInstDate(S.datepicker._getInst(am),stepMonths,"M");return}}b(am)}function u(am){let parameters=w(am);let calendarDefault=g("minStay",parameters,"number");return F(calendarDefault)?calendarDefault:availabilityCalendar.defaults.minStay}function n(am,an){return al(am,an,"object")}function aj(am,an){let data=g(am,an,"object");return(undefined===data)?{}:data}function l(am){let rate=g("rate",am,"string");return(undefined===rate)?"":rate}function X(am){let available=g("available",am,"boolean");return(undefined===available)?false:available}function r(am){let arrivalAllowed=g("arrival",am,"boolean");return(undefined===arrivalAllowed)?false:arrivalAllowed}function A(am){let departureAllowed=g("departure",am,"boolean");return(undefined===departureAllowed)?false:departureAllowed}function T(am,an){if(n(am,an)){return X(aj(am,an))}return false}function P(am,an){if(n(am,an)){return A(aj(am,an))}return false}function E(am,an){let dates=o(an);if(n(am,dates)){let dateMinStay=g("minStay",aj(am,dates),"number");if(F(dateMinStay)){return dateMinStay}}return u(an)}function R(am,an){let dates=o(an);let defaultMaxStay=D("maxStay",an);return(dates.hasOwnProperty(am)&&("number"===typeof dates[am].maxStay)&&(0<dates[am].maxStay))?dates[am].maxStay:((("number"===typeof defaultMaxStay)&&(0<defaultMaxStay))?defaultMaxStay:availabilityCalendar.defaults.maxStay)}function z(an,am){let format=ak(am);return ai(M(V(an,format),E(an,am)),format)}function U(an,am){let dates=o(am);if(!T(an,dates)){return an}let format=ak(am);let arrivalDate=V(an,format);let addDays=1;let newDate="";let maxStay=R(an,am);while(T(newDate=ai(M(arrivalDate,addDays),format),dates)){if(addDays>=maxStay){return newDate}addDays++}return newDate}function Z(an,am){let dates=o(am);if(P(an,dates)){return an}let lastDate=D("lastDate",am);let format=ak(am);let addDays=1;let newDate=ai(M(V(an,format),addDays),format);while(!P(newDate,dates)&&ac(newDate,lastDate,format)){addDays++;newDate=ai(M(V(an,format),addDays),format)}return newDate}function c(am,an){let oldState=(L===am)?C:L;O(am,an).forEach(function(ao){try{S(ao.parentNode).removeClass("calendar-deem").addClass("calendar-highlight")}catch(ap){console.log(ap)}});O(oldState,an).forEach(function(ao){try{S(ao.parentNode).removeClass("calendar-highlight").addClass("calendar-deem")}catch(ap){console.log(ap)}})}function k(ao,an,aq,ap,am){Q("selected-"+an,ao,aq);let inputField=e(an,aq);inputField.value=ao;let displayInputField=e(an+"Display",aq);if(null!==displayInputField){displayInputField.value=(""===ao)?ao:I(ao,ap,am)}}function j(am){let fields=[L,C];for(let index in fields){let field=fields[index];let inputField=e(field,am);if((null!==inputField)&&("string"===typeof inputField.value)&&(""!==inputField.value)){Q("selected-"+field,inputField.value,am);let displayInputField=e(field+"Display",am);if(null!==displayInputField){displayInputField.value=I(inputField.value,ak(am),ad(am))}}}}function ah(am){if(true===D("showRates",am)){let format=ak(am);let dates=o(am);S(am).find('.ui-datepicker-calendar td.has-rate[class*="date-key-"] > *[class*="ui-state"]').each(function(){let date=q(this.parentNode.className,format);let rate="";if((undefined!==date)&&n(date,dates)&&(""!==(rate=l(aj(date,dates))))&&(0===S(this.parentNode).find(".rate").length)){let rateElement=document.createElement("span");rateElement.className="rate";rateElement.appendChild(document.createTextNode(rate));this.parentNode.appendChild(rateElement)}})}S(am).find(".ui-datepicker-calendar td[title]").contextmenu(function(an){an.preventDefault();try{alert(this.getAttribute("title").replace(/\.\s?/gi,".\n"))}catch(ao){console.log(ao)}});if(ae===G(am)){let currentState=s(am);let selector=(L===currentState)?"td.arrival-available.arrival-prohibited":"td.departure-available.departure-prohibited";let message=(L===currentState)?availabilityCalendar.messages.alertNoArrivals:availabilityCalendar.messages.alertNoDepartures;S(am).find(selector).on("click",function(){alert(message)})}}function b(am){window.setTimeout(function(an){ah(an)},250,am)}function h(an,am,ao){return ao.indexOf(an)===am}function W(am){let classes=[];let messages=[];let state=s(this);let format=D("dateFormat",this);let dates=o(this);let theDateString=ai(am,format);let theDateKey=ai(am,p);classes.push("date-key-"+theDateKey);let firstDate=V(D("firstDate",this),format);let beforeMinDate=(am<firstDate);if(beforeMinDate){classes.push("before-min-date")}let afterMaxDate=(am>V(D("lastDate",this),format));if(afterMaxDate){classes.push("after-max-date")}let hasData=n(theDateString,dates);classes.push(hasData?"has-data":"no-data");let dateData=aj(theDateString,dates);let rate=l(dateData);let hasRate=(""!==rate);if(!beforeMinDate&&!afterMaxDate){classes.push(hasRate?"has-rate":"no-rate")}let arrivalAvailable=(X(dateData)&&!(beforeMinDate||afterMaxDate));classes.push(arrivalAvailable?"arrival-available":"arrival-unavailable");let yesterdayDate=M(am,-1);let yesterdayDateString=ai(yesterdayDate,format);let yesterdayData=aj(yesterdayDateString,dates);let departureAvailable=(X(yesterdayData)&&!(beforeMinDate||afterMaxDate)&&!(yesterdayDate<firstDate));classes.push(departureAvailable?"departure-available":"departure-unavailable");let arrivalAllowed=r(dateData);classes.push(arrivalAllowed?"arrival-allowed":"arrival-prohibited");let departureAllowed=A(dateData);classes.push(departureAllowed?"departure-allowed":"departure-prohibited");if(!beforeMinDate&&!afterMaxDate){if(hasRate){messages.push(availabilityCalendar.messages.rate.replace("{rate}",rate))}messages.push(availabilityCalendar.messages.minimumStay.replace("{minimumStay}",E(theDateString,this)));messages.push(arrivalAvailable?availabilityCalendar.messages.available:availabilityCalendar.messages.unavailable);messages.push(arrivalAllowed?availabilityCalendar.messages.arrivalsAllowed:availabilityCalendar.messages.arrivalsNotAllowed);messages.push(departureAllowed?availabilityCalendar.messages.departuresAllowed:availabilityCalendar.messages.departuresNotAllowed)}let canArrive=(arrivalAvailable&&arrivalAllowed);let canDepart=(departureAvailable&&departureAllowed);let selectedArrivalDateString=H("selected-arrival",this);let selectedArrivalDate=V(selectedArrivalDateString,format);let isSelectedArrival=((null!==selectedArrivalDate)&&ab(am,selectedArrivalDate));if(isSelectedArrival){classes.push("selected-arrival");messages.push(availabilityCalendar.messages.selectedArrival);if(!canArrive||beforeMinDate||afterMaxDate){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}}let selectedDepartureDateString=H("selected-departure",this);let selectedDepartureDate=V(selectedDepartureDateString,format);let isSelectedDeparture=((null!==selectedDepartureDate)&&ab(am,selectedDepartureDate));if(isSelectedDeparture){classes.push("selected-departure");messages.push(availabilityCalendar.messages.selectedDeparture);if(!canDepart||beforeMinDate||afterMaxDate){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}if((null!==selectedArrivalDate)&&(null!==selectedDepartureDate)){if((selectedArrivalDate<am)&&(am<selectedDepartureDate)){classes.push("selected-stay");messages.push(availabilityCalendar.messages.selectedStay);if((!arrivalAvailable&&!departureAvailable)||beforeMinDate||afterMaxDate){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.selectedStayConflict)}else{if(!arrivalAvailable){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.selectedArrivalConflict)}else{if(!departureAvailable){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.selectedDepartureConflict)}}}}let minimumStayUntilDate=V(z(selectedArrivalDateString,this),format);if((selectedDepartureDate<minimumStayUntilDate)){if(isSelectedArrival){classes.push("arrival-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if(isSelectedDeparture){classes.push("departure-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}else{if((selectedArrivalDate<am)&&(am<selectedDepartureDate)){classes.push("stay-conflict");messages.push(availabilityCalendar.messages.minimumStayConflict)}}}}}let minDepartureDateString=H("first-departure",this);let minStayMessage=false;if((C===state)&&(""!==minDepartureDateString)){if((""!==selectedArrivalDateString)&&(theDateString===selectedArrivalDateString)){classes.push("minimum-stay-requirement");minStayMessage=true}else{if((""!==selectedArrivalDateString)&&(N(selectedArrivalDateString,theDateString,format))&&(N(theDateString,minDepartureDateString,format))){classes.push("minimum-stay-requirement selected-stay");minStayMessage=true}else{if(theDateString===minDepartureDateString){classes.push("minimum-stay-requirement selected-departure");messages.push(availabilityCalendar.messages.firstAvailableDeparture)}}}if(true===minStayMessage){messages.push(availabilityCalendar.messages.minimumStayPeriod)}}let selectable=false;if(L===state){selectable=canArrive}else{selectable=(canDepart&&K(theDateString,H("first-departure",this),H("last-departure",this),format))}let uniqueClasses=classes.filter(h);let uniqueMessages=messages.filter(h);return[selectable,uniqueClasses.join(" "),uniqueMessages.join(" ")]}function t(an,am,ao){let state=s(ao);if(L===state){let messages=[];let mustDepartOnDateString=U(an,ao);let minimumStayUntilDateString=z(an,ao);let firstAllowedDepartureDateString=Z(minimumStayUntilDateString,ao);if(N(mustDepartOnDateString,firstAllowedDepartureDateString,am.settings.dateFormat)){messages.push(availabilityCalendar.messages.arrivalImpossible);messages.push(availabilityCalendar.messages.selectAnotherDate);alert(messages.join("\n"));b(ao);return}k("",C,ao,am.settings.dateFormat,am.settings.altFormat);Q("first-departure",firstAllowedDepartureDateString,ao);Q("last-departure",mustDepartOnDateString,ao)}else{if(C===state){ag("first-departure",ao);ag("last-departure",ao)}}k(an,state,ao,am.settings.dateFormat,am.settings.altFormat);d(ao)}function Y(am){return Math.max(1,Math.floor(am.offsetWidth/317.2))}function m(am){let instance=S.datepicker._getInst(am);let date=S.datepicker.parseDate("yy-m-d",instance.drawYear+"-"+(1+instance.drawMonth)+"-"+instance.currentDay);let fields=[L,C];for(let f in fields){k("",fields[f],am,instance.settings.dateFormat,instance.settings.altFormat)}let attributes=["selected-arrival","selected-departure","first-departure","last-departure"];for(let a in attributes){ag(attributes[a],am)}aa(am,L);S(am).datepicker("setDate",null);S(am).datepicker("refresh");S(am).datepicker("setDate",date);b(am)}function B(am,an){j(an);aa(an,L);let arrivalInput=e(L,an);let defaultDate=((null===arrivalInput)||(""===arrivalInput.value))?null:arrivalInput.value;let calendarParameters=w(an);let parameters={beforeShowDay:W,altFormat:calendarParameters.dateFormatDisplay,dateFormat:calendarParameters.dateFormat,firstDay:calendarParameters.weekStart,defaultDate:defaultDate,gotoCurrent:true,maxDate:calendarParameters.lastDate,minDate:calendarParameters.firstDate,showOtherMonths:false,numberOfMonths:Y(an),onChangeMonthYear:function(){b(this)},onSelect:function(){b(this)}};let calendarType=G(an);switch(calendarType){case J:S(an).datepicker(parameters);break;case ae:default:parameters.onSelect=function(ap,ao){t(ap,ao,this)};S(an).datepicker(parameters);y(an);break}b(an)}S(".availability-calendar-clear .clear-button").on("click",function(){try{let calendar=S(S(this).closest(".availability-calendar-wrapper")[0]).find(".availability-calendar.hasDatepicker")[0];if(undefined===calendar){return}m(calendar)}catch(am){console.log(am)}});S(".availability-calendar-help .help-button").on("click",function(){S(this.parentNode.parentNode).toggleClass("state-open")});S(".availability-calendar").each(B);S(window).on("resize",function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){S(".availability-calendar").each(function(am,an){S(an).datepicker("option","numberOfMonths",Y(an));S(an).datepicker("refresh");b(an)})},250)})});